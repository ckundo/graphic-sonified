let result, el, ctx, path, noise, playing, audioCtx;

function handleMove(event) {
  event.preventDefault();
  const touches = event.changedTouches;
  [...touches].forEach(touch => {
    result.innerText = [touch.pageX, touch.pageY];

    if (ctx.isPointInPath(path, touch.pageX, touch.pageY)) {
      if (noise && playing) { audioCtx.suspend(); playing = false; el.style.opacity = 1; }
    } else {
      if (noise && !playing) { audioCtx.resume(); playing = true; el.style.opacity = 0.8; }
    }
  });
}

function load() {
  el = document.querySelector("#canvas");
  audio = document.querySelector("audio");
  path = new Path2D("M20.69,329.91a63.4,63.4,0,0,0-.44,15.45c2.27,34.85,3.48,69.75,5,104.64.29,6.49,2.32,12.55,4.67,18.72,3.44,9,8.12,17.73,9.53,27.54.3,2.13-.34,4-.69,5.84-1.67,8.68-1.17,17.56-2.7,26.24-.4,2.29-1,4.48-3.38,6.29-1.24-4.72-2.34-9.19-2.09-13.76a16.93,16.93,0,0,0-3.29-11.25c-3.27-4.49-4.93-10-10.17-13.28-2.57-1.59-3.12-5.32-3.27-8.59a81.35,81.35,0,0,1,2.07-23.27,39.46,39.46,0,0,0-.18-18.77,33.94,33.94,0,0,1-.74-6.92,460.13,460.13,0,0,0-9.55-82.61c-3.52-16.45-4.8-33.26-5.32-50-.53-16.94.79-33.93.45-50.85-.38-19.14,4-37,9.9-54.88a201.19,201.19,0,0,1,17.1-38.14c8.66-14.8,17.59-29.46,29.49-42.25,7.68-8.26,14.36-17.69,23.68-24,12-8.1,22.39-18.24,35.48-24.86,10-5.09,18.56-12.8,28.44-18.42,11.68-6.64,23.82-12.27,36.62-15.6,17-4.44,33.77-10.44,51.39-12.31,14.15-1.51,28.13-3.2,42.67-1.55,11.92,1.35,23.93,3.74,36.16,3.08,9.25-.5,17.7,4.22,26.86,5.12C352.25,32.82,366,35.34,380,36.24c4.47.29,8.88,1.6,13.34,1.76a130.66,130.66,0,0,0,33.62-3.28c32.13-7.3,63.48-17.44,95-26.87C534.27,4.16,546.85.77,560,.11c16.94-.85,32.86,3.46,49,7.6,7.65,2,15,5.47,23.07,5.81a11.93,11.93,0,0,1,5.69,1.71c16.59,10.64,35.55,8.29,53.74,9.72,13.42,1.05,26.84,2.15,40.23,3.55a55.78,55.78,0,0,0,10.91-.41c10.23-.87,20.15,2.19,30.3,2.36a10.52,10.52,0,0,1,5.15,1.76c11.2,7.11,24.29,8.87,36.54,12.94,10,3.33,20.1,7.34,28.18,13.53,6.63,5.09,12.2,12.95,13.44,22.47,2.44,18.69,6.87,37,15.7,53.66,5.79,10.91,11.35,21.79,15.28,33.48A33.47,33.47,0,0,1,889,175,75.09,75.09,0,0,0,897.59,202c4.44,8.4,8.42,17,10.06,26.46,2,11.25,6.79,21.55,10.06,32.34,4.76,15.7,9.94,31.3,12.82,47.55,1.14,6.4,1.93,12.8,2.64,19.23.76,7,6,11,14.3,12.2,9.36,1.4,18.78,2.12,28.18,3.08a12.86,12.86,0,0,1,5.63,1.89c2.6,1.66,4,3.62,3,7.06-.9,3.24-2.61,4.9-5.9,5-10.95.17-21.93-.4-32.83-.27-22.43.27-37.52-13.45-53.74-25.44-6.62-4.89-11.91-11.14-17-17.45-3-3.7-4.67-1-7,.27-2.91,1.58-2.58,3.55-.85,5.69,10.13,12.55,21,24.11,36.27,30.76,13.22,5.75,26.11,12.24,39.94,16.49a39.9,39.9,0,0,0,9.75,2c5.54.28,10.46,5.41,10.48,10.76,0,2.61-1.89,2.86-3.82,2.71-8.29-.65-16.66-.93-24.7-3.2-4.11-1.15-4.85.16-4.85,3.95,0,11-3,21.6-4.9,32.35a25.91,25.91,0,0,0-.81,3.38,359,359,0,0,1-8.29,61.85c-5,23-10.41,46.32-24.57,65.85-10.86,15-21.11,30.92-39.12,39-14.75,6.58-30.27,8.26-45.27,3.32-12.36-4.07-23.65-14.87-23.12-28.81.35-9.18,5.61-18,13.07-20.82,8.3-3.18,17-1.51,22.63,4.36,4.95,5.18,4.33,7.39-2.22,10.13-3,1.25-5.63,3.43-8.42,5.21-.58.38-1.08,1-.64,1.64a2.28,2.28,0,0,0,1.63.84c12.53-.31,24.46-2.74,32.53-13.29,9.27-12.13,15.49-26.09,19.56-40.66,3.45-12.36,3.9-25.37,4.82-38.18.81-11.42,0-23,.73-34.3,1.21-20.38-2.3-40.35-2.81-60.53a9.19,9.19,0,0,0-.75-3.89c-5.93-11.21-4.27-24.29-9.1-35.94-2.39-5.75-2.95-11.94-8.17-16.46-3.23-2.79-6.72-5-10.63-4.76-8.05.48-14.59-2.84-20.87-6.92-3.69-2.39-5.22-1.18-6.61,2.27a61.17,61.17,0,0,1-4.23,9c-2.13,3.55-5.39,4.89-9.42,3.16-12.81-5.52-25.24-11.58-33.84-23.24-1.67-2.28-3.87-4-6.83-2.78-6.41,2.61-12.28.42-17.7-2.39a45.51,45.51,0,0,1-13.36-10.25c-3.08-3.52-14.39-5.91-18.55-3.86-2.63,1.29-2,4-2.79,6.05-1,2.47-.25,6.55-3.91,6.66-3.12.09-3.3-3.69-4.4-6a45.9,45.9,0,0,1-1.92-5.14c-2.9-8.46-8-11.75-16.71-11-3.33.29-4.67,2.43-5,5.27-.52,4.79-1.89,9.09-5.62,12.4a3.54,3.54,0,0,0-1,1.72c-3.78,15.35-10.76,29.8-9.58,46.51.65,9.13,1.64,18.35,1.79,27.44.33,19.43,2.78,38.93-3.33,58.37a133.6,133.6,0,0,0-5.62,33.22c-.25,5.06-2.12,10.05-3.27,15.07a87.36,87.36,0,0,0-2.06,19.81c.07,12.95-3.62,25.23-6.84,37.59a6.74,6.74,0,0,0-.57,1.9c1,13.19-3.5,25.28-7,37.66A68.21,68.21,0,0,0,624.93,589c.59,8.34,5.36,14.83,12,20a98.3,98.3,0,0,1,14,12.72c6.27,7.12,7,15.54,7.17,24.21.07,3.78-2.1,6-6.19,6.39a386.92,386.92,0,0,1-43.33,2.07c-5.72-.1-11.45,1.65-17.2,2.34a81,81,0,0,1-21.39,0c-15.71-2.3-31.38-3-47.09.33-8,1.67-20.28-6.86-22-14.8-.69-3.25-.27-6.69,1.85-9,8.95-9.93,8.85-22.35,9.52-34.36.78-13.77-.71-27.71,1.18-41.36,3.29-23.64-1.45-46.78-3.26-70.08-.67-8.65-3.69-17.2-6.25-25.61-3.55-11.64-8-23-11.43-34.69-2.43-8.23-8.67-13.13-14.33-18.62-1.69-1.63-4.13-.77-6.26-.44-11.45,1.81-22.11,5.92-32.59,10.76-6.36,2.94-12.16,6.84-18.33,10a258.69,258.69,0,0,1-68,24,80.36,80.36,0,0,1-21.33,1.2,25,25,0,0,0-15.32,3.42c-5.66,3.48-11.38,6.89-17.67,9.24a27.56,27.56,0,0,0-6.07,3.42c-7,4.93-7.35,6.5-3.91,14.41s4.56,16.73,5,25.31c.86,16,2.94,31.73,8.33,46.9a2.32,2.32,0,0,1,.25,1c-1.52,10.31,4.7,17.13,11.19,23.46A125.1,125.1,0,0,0,331,595.59c3.32,2.23,6.14,4.34,7.79,8,1.86,4.09,3.93,8.08,5.66,12.22,1.43,3.4.35,6.08-2.17,9-12.79,14.68-30.54,16-47.85,17.35-15.23,1.22-30.59.16-45.87-.88-9.65-.66-18.33-10.09-17.87-19.76.59-12.58,0-24.92-5.45-36.58-1-2.16-.73-4.58-.71-6.9,0-4.16.26-8.31-1.14-12.35a7.89,7.89,0,0,1,0-5.42c2.6-6.66,1.82-13.8,3.17-20.64.63-3.21-.21-6.29-1.38-9.26-1.65-4.17-2.18-8.34-.33-12.61.53-1.23,1.05-2.75.31-3.87-3.49-5.27-3-11.5-4.36-17.26a14.57,14.57,0,0,0-3.78-7.43c-4.39-4.31-6.3-10.06-8.68-15.53-3.64-8.38-9.74-11.42-18.58-9.57-8.66,1.81-17.5,2.08-26.3,2.56-8.61.47-13.55,5.32-13.51,13.87a45.16,45.16,0,0,1-2.21,15.16c-1.86,5.42-.09,11.27.51,16.8,1.76,16.47,5,32.81,6.23,49.31.7,9.71,2.72,19,4.76,28.36,1.7,7.79,6.76,14.9,13.88,18,10.27,4.41,18.59,26.61,16.77,36.79-.65,3.6-3.49,3.95-6.36,4.46-13.78,2.48-27.77,3.21-41.65,4.78-18.24,2.06-36.56.92-54.81-.48-7.51-.58-12.62-5.66-13-13.14-.46-10.19-1.87-20.31,2.79-30.37,3.54-7.62,2.93-16.43,3.57-24.87,1.26-16.56,3.37-33.05,4.4-49.65.65-10.71-.64-21.47-2.56-31.73-2.22-11.85-6-23.42-12.76-34.38-6-9.79-13.58-18.22-19.71-27.75a5.93,5.93,0,0,1-1.07-2.24c-1.1-9.06-4.25-17.67-6.1-26.47-2-9.7-5-19.32-6.11-29.14a222.57,222.57,0,0,0-4.9-26.9C29.42,347.88,28.17,338.31,20.69,329.91Z");
  result = document.querySelector("#result");

  el.height = 1000;
  el.width = 1000;

  el.onclick = (_) => {
    const AudioContext = window.AudioContext || window.webkitAudioContext;
    audioCtx = new AudioContext();
    const bufferSize = audioCtx.sampleRate * 1000;
    const buffer = audioCtx.createBuffer(1, bufferSize, audioCtx.sampleRate);
    let data = buffer.getChannelData(0);

    for (let i = 0; i < bufferSize; i++) {
      data[i] = Math.random() * 2 - 1;
    }

    noise = audioCtx.createBufferSource();
    noise.buffer = buffer;
    noise.connect(audioCtx.destination);
    noise.start();
  };
  el.addEventListener("touchmove", handleMove, false);
  el.style.opacity = 0.8;
  ctx = el.getContext('2d');
  ctx.stroke(path);
  ctx.fill(path);
}

document.addEventListener("DOMContentLoaded", load);
